<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Lucky Creations: Doilies</title>
    <link rel="icon" type="image/png" href="../media/centerpiece-main.png">
    <link rel="stylesheet" type="text/css" href="../css-files/everywhere.css"/>
    <link rel="stylesheet" type="text/css" href="../css-files/header.css"/>
    <link rel="stylesheet" type="text/css" href="../css-files/delivery.css"/>
    <link rel="stylesheet" type="text/css" href="../css-files/products.css"/>

    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
</head>

<body oncontextmenu="return false">
<div class="header"> <!--Beginning of the header-->
    <div class="left-section">
      <div class="hamburger-icon-container">
        <picture>
          <source srcset="../media/hamburger-icon.webp" type="image/webp">
          <img class="hamburger-icon"
               alt="toggle-icon"
               src="../media/hamburger-icon.png"
               width="24" height="24"
               decoding="async"
               onclick="toggleMenu()"
               draggable="false"
               ondragstart="return false;">
        </picture>
      </div>

      <div class="header-logo-container">
        <!-- Use a relative link to avoid GitHub Pages subpath issues -->
        <a rel="website" href="../index.html">
          <picture>
            <source srcset="../media/upscale.webp" type="image/webp">
            <img class="header-logo"
                 alt="the-logo"
                 src="../media/upscale.png"
                 width="756" height="251"
                 loading="eager"
                 fetchpriority="high"
                 decoding="async"
                 draggable="false"
                 ondragstart="return false;">
          </picture>
        </a>
      </div>
    </div>

    <div class="middle-section">
      <div class="page-title-container">
        <hr class="top-line"> <!-- Top line -->
        <div class="page-title">Doilies</div>
        <hr class="bottom-line"> <!-- Bottom line -->
      </div>
    </div>

    <div class="right-section">
      Complete <br> Catalogue
    </div>
  </div> <!--Ending of the header-->

<div id="dropdown-menu" class="dropdown hidden">
  <a href="about-us.html">About Us</a>
  <a href="contact.html">Contact Us</a>
</div>

<div id="backdrop" class="backdrop hidden" onclick="closeMenu()"></div>

    <div class="delivery-bar"> <!--Beginning of the delivery bar-->
        <marquee>
            Pan-India Delivery Available. Contact &#9742; +91 8169341750 &#9679; &#9993;
            <a href="mailto:luckycreations.crochet@gmail.com?subject=Inquiry%20About%20Catalogue">
            luckycreations.crochet@gmail.com
            </a>
        </marquee>
</div> <!--Ending of the delivery bar-->

<div id="controls">
<div id="filters">
  <label class="filter-label">

<svg class="funnel-icon" viewBox="0 0 24 24" width="18" height="18">
  <!-- Funnel outline -->
  <path d="M6 6 H18 L14 14 L13 22 L11 22 L10 14 Z" fill="#f7f7f2"/>
  <!-- Fluid rectangle -->
</svg>

    <span>Filter:</span>
    <select id="filter-select">
      <option value="normal">All</option>
      <option value="dual">Dual Tone</option>
      <option value="multi">Multi-Coloured</option>
      <option value="mono">Monochrome</option>
    </select>
  </label>
</div>

  <div id="sort">
  <label class="sort-label">
    <svg class="sort-icon" viewBox="0 0 24 24" width="18" height="18">
      <path d="M7 10l5-5 5 5H7z"/> <!-- up arrow -->
      <path d="M7 14l5 5 5-5H7z"/> <!-- down arrow -->
    </svg>
    <span>Sort:</span>
    <select id="sort-select">
      <option value="default">Default</option>
      <option value="price-low">Price: Low to High</option>
      <option value="price-high">Price: High to Low</option>
      <option value="small-size">Size: Smaller to Bigger</option>
      <option value="big-size">Size: Bigger to Smaller</option>
      <option value="bestsellers">Bestsellers First</option>
      <option value="new">New Arrivals First</option>
    </select>
  </label>
</div>
</div>

  <main id="product-container"></main>

<script>
function renderCatalogue(list) {
  const container = document.getElementById('product-container');
  container.innerHTML = '';

  if (!Array.isArray(list) || list.length === 0) {
    container.innerHTML = '<p class="empty">No products available right now.</p>';
    return;
  }

  const toBase = f => (f || '').trim().replace(/\.(webp|png|jpe?g|avif)$/i, '');
  const enc = s => encodeURIComponent(s);

  list.forEach(item => {
    const name  = item.name  || 'Item';
    const size  = item.size  || '';
    const rate  = item.rate  || '';
    const file  = (item.image || '').trim();
    const base  = toBase(file);

    const webpUrl = `../products/doilies/${enc(base)}.webp`;
    const pngUrl  = `../products/doilies/${enc(file)}`;

    // Optional intrinsic size support if width/height is added in JSON
    const w = item.width  || '';
    const h = item.height || '';

    const card = document.createElement('div');
    card.className = 'product-card';

    if (item.bestseller) {
      const badge = document.createElement('div');
      badge.className = 'bestseller-badge';
      badge.textContent = 'Bestseller';
      card.appendChild(badge);
    }
    if (item.new) {
      const mark = document.createElement('div');
      mark.className = 'new-arrival';
      mark.textContent = 'New Arrival';
      card.appendChild(mark);
    }

    const picture = document.createElement('picture');
    const source = document.createElement('source');
    source.type = 'image/webp';
    source.srcset = webpUrl;
    picture.appendChild(source);

    const img = document.createElement('img');
    img.src = pngUrl;
    img.alt = name;
    img.loading = 'lazy';
    img.decoding = 'async';
    if (w && h) { img.width = w; img.height = h; } // keeps layout stable when provided
    img.setAttribute('draggable', 'false');
    picture.appendChild(img);

    card.addEventListener('click', (e) => {
      if (e.target.closest('a')) return; // spare WhatsApp link

      const modal = document.getElementById('image-modal');
      const modalImg = document.getElementById('modal-img');
      const caption = document.getElementById('caption-name');
      const copyright = document.getElementById('copyright-label');

      // Preventing dragging images in HTML
      modalImg.setAttribute('draggable', 'false');
      modalImg.ondragstart = (e) => e.preventDefault();

      modal.style.display = "block";
      modalImg.src = img.src;
      caption.textContent = name;

      document.querySelector('.close').onclick = () => {
          modal.style.display = "none";
        };
      });

    card.appendChild(picture);

    const pName = document.createElement('p');
    pName.innerHTML = `<strong>Name:</strong> ${name}`;
    card.appendChild(pName);

    const pSize = document.createElement('p');
    pSize.innerHTML = `<strong>Size:</strong> ${size}`;
    card.appendChild(pSize);

    const pRate = document.createElement('p');
    pRate.innerHTML = `<strong>Price:</strong> ${rate}`;
    card.appendChild(pRate);

    const a = document.createElement('a');
    const msg = item.whatsapp || `Hi! I'm interested in the ${name} from Lucky Creations.`;
    a.href = `https://wa.me/918169341750?text=${encodeURIComponent(msg)}`;
    a.target = '_blank';
    a.textContent = 'Purchase Design on WhatsApp';
    a.rel = 'noopener';
    card.appendChild(a);

    container.appendChild(card);
  });
}

fetch('../json-files/doilies.json')
  .then(res => res.json())
  .then(products => {
    renderCatalogue(products);

    const parsePrice = p => Number(p.rate.replace(/[^\d]/g, ''));
    const parseSize = p => Number(p.size.replace(/[^\d]/g, ''));

    //
    function updateSortOptions(list) {
      const sortSelect = document.querySelector('#sort select');
      const hasNew = list.some(p => p.new);
      sortSelect.querySelector('option[value="new"]').disabled = !hasNew;
      const hasBestseller = list.some(p => p.bestseller);
      sortSelect.querySelector('option[value="bestsellers"]').disabled = !hasBestseller;
    }

    document.querySelector('#filters select').addEventListener('change', e => {
      const filter = e.target.value;
      let filtered = [...products];
      if (filter === "dual") {
        filtered = products.filter(p => p.category === "dual");
      } else if (filter === "multi") {
        filtered = products.filter(p => p.category === "multi");
      } else if (filter === "mono") {
        filtered = products.filter(p => p.category === "mono");
      }
      renderCatalogue(filtered);
    });

    document.querySelector('#sort select').addEventListener('change', e => {
  const sort = e.target.value;
  let sorted = [...products];

  if (sort === "price-low") {
    sorted.sort((a, b) => parsePrice(a) - parsePrice(b));
  } else if (sort === "price-high") {
    sorted.sort((a, b) => parsePrice(b) - parsePrice(a));
  } else if (sort === "small-size") {
    sorted.sort((a, b) => parseSize(a) - parseSize(b));
  } else if (sort === "big-size") {
    sorted.sort((a, b) => parseSize(b) - parseSize(a));
  } else if (sort === "bestsellers") {
    // put bestsellers first, then others
    sorted.sort((a, b) => (b.bestseller === true) - (a.bestseller === true));
  } else if (sort === "new") {
    // put new arrivals first, then others
    sorted.sort((a, b) => (b.new === true) - (a.new === true));
  }

  renderCatalogue(sorted);
});

// Keep track of current filter + sort
let currentFilter = "all";
let currentSort = "default";

function applyFilterAndSort() {
  let list = [...products];

  // Filter first
  if (currentFilter === "dual") {
    list = list.filter(p => Array.isArray(p.category) ? p.category.includes("dual") : p.category === "dual" );
  } else if (currentFilter === "multi") {
    list = list.filter(p => Array.isArray(p.category) ? p.category.includes("multi") : p.category === "multi" );
  } else if (currentFilter === "mono") {
    list = list.filter(p => Array.isArray(p.category) ? p.category.includes("mono") : p.category === "mono" );
  }

  updateSortOptions(list);

  // Then sort
  if (currentSort === "price-low") {
    list.sort((a, b) => parsePrice(a) - parsePrice(b));
  } else if (currentSort === "price-high") {
    list.sort((a, b) => parsePrice(b) - parsePrice(a));
  } else if (currentSort === "small-size") {
    list.sort((a, b) => parseSize(a) - parseSize(b));
  } else if (currentSort === "big-size") {
    list.sort((a, b) => parseSize(b) - parseSize(a));
  } else if (currentSort === "bestsellers") {
    // reorder so bestsellers come first
    list.sort((a, b) => (b.bestseller === true) - (a.bestseller === true));
  } else if (currentSort === "new") {
    // reorder so new arrivals come first
    list.sort((a, b) => (b.new === true) - (a.new === true));
  }

  renderCatalogue(list);
}

// Filter dropdown
document.querySelector('#filters select').addEventListener('change', e => {
  currentFilter = e.target.value;
  applyFilterAndSort();
});

// Sort dropdown
document.querySelector('#sort select').addEventListener('change', e => {
  currentSort = e.target.value;
  applyFilterAndSort();
});

  })
  .catch(err => {
    document.getElementById('product-container').innerHTML =
      '<p class="error">Loading products soon! Please try again later.</p>';
    console.error('Error loading doilies:', err);
  });
</script>

<script>
  function toggleMenu() {
    document.getElementById("dropdown-menu").classList.toggle("hidden");
    document.getElementById("backdrop").classList.toggle("hidden");
  }

  function closeMenu() {
    document.getElementById("dropdown-menu").classList.add("hidden");
    document.getElementById("backdrop").classList.add("hidden");
  }
</script>

<!-- Preventing right-clicking in Javascript embedded in HTML -->
  <script>
    document.addEventListener('contextmenu', e => e.preventDefault());
  </script>

<!-- Preventing dragging images in Javascript embedded in HTML -->
  <script>
document.querySelectorAll('.header-logo').forEach(el => {
  el.setAttribute('draggable', 'false');
  el.addEventListener('dragstart', e => e.preventDefault());
});
</script>

  <script>
document.querySelectorAll('.hamburger-icon').forEach(el => {
  el.setAttribute('draggable', 'false');
  el.addEventListener('dragstart', e => e.preventDefault());
});
</script>

  <script>
document.addEventListener('dragstart', function(e) {
  if (e.target.tagName === 'IMG') {
    e.preventDefault();
  }
});
</script>

<!-- Disabling keys -->
<script>
  document.addEventListener('keydown', e => {
  if (e.ctrlKey && ['s','u','i','p'].includes(e.key.toLowerCase())) {
    e.preventDefault();
    alert("This shortcut is disabled to protect copyrighted content.");
  }
});
</script>

<!-- Discouraging screenshots -->
<script>
  document.addEventListener('keyup', e => {
  if (e.key === 'PrintScreen' || e.key === 44) {
    alert("Screenshots are discouraged due to copyright.");
  }
});
</script>

<!-- Image Modal -->
  <div id="image-modal" class="modal">
    <span class="close">&times;</span>
    <img class="modal-content" id="modal-img">
    <div id="caption-name"></div>
    <div id="copyright-label">© 2025-2026 Lucky Creations. All rights reserved.</div>
  </div>

  <footer class="note-footer">
  <hr>
  <div class="footer-text">
    The colours may or may not vary as per their availability. Please confirm at the time of purchase.<br>
    © 2025-2026 Lucky Creations. All rights reserved.
  </div>
  </footer>

</body>

</html>
